(()=>{if(console.log("content script running"),!document.getElementById("floating-sidebar-root")){const e=document.createElement("div");e.id="floating-sidebar-root",document.body.appendChild(e)}chrome.runtime.onMessage.addListener(((n,o,i)=>{console.log("Message received in content script:",n),"extract_content"===n.action?i({content:function(){const e=document.querySelectorAll("article p");let t="";return e.forEach((e=>{t+=e.innerText+"\n"})),console.log("Extracted page content:",t),t}()}):"start_highlight_mode"===n.action&&(e=!0,document.addEventListener("mouseup",t),console.log("Highlight mode activated."),i({status:"Highlight mode started"}))}));let e=!1;function t(){if(!e)return;const n=window.getSelection();if(n&&n.toString().trim()){const o=n.toString();console.log("Highlighted text:",o);const i=n.getRangeAt(0),c=document.createElement("span");c.style.background="lightblue",c.style.borderRadius="3px",c.textContent=o,i.deleteContents(),i.insertNode(c),chrome.runtime.sendMessage({action:"text_highlighted",text:o}),e=!1,document.removeEventListener("mouseup",t),console.log("Highlight mode deactivated.")}}})();